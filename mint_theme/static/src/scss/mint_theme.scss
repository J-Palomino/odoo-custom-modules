/**
 * Mint Green Theme for Odoo
 * ========================
 * Changes the default purple to dark green
 */

// Dark Green Color Palette (replacing mint green)
$green-primary: #15803D;        // Dark green (primary)
$green-dark: #166534;           // Darker green for hover
$green-darker: #14532D;         // Even darker for active states
$green-light: #22C55E;          // Light green for highlights
$green-bg: #DCFCE7;             // Very light green for backgrounds

// ============================================
// NUCLEAR OPTION: Override Odoo's purple at the source
// Odoo 19 purple values: #714B67, #7C3AED, #875A7B, #7C7BAD
// ============================================

// DIRECT NAVBAR OVERRIDE - target the actual navbar structure
// Target span[data-section] which is what Odoo 19 uses for menu items
.o_main_navbar .o_menu_sections [data-section],
.o_main_navbar .o_menu_sections span[data-section],
.o_main_navbar .o_menu_sections .dropdown-toggle,
.o_main_navbar .o_menu_sections .nav-link,
.o_main_navbar .o_menu_sections > .dropdown,
.o_main_navbar .o_menu_sections > a,
.o_main_navbar .o_menu_sections > button,
.o_main_navbar .o_menu_sections .o-dropdown,
.o_main_navbar .o_menu_sections .o-dropdown-toggler,
.o_main_navbar .o_menu_sections [data-menu-xmlid],
nav.o_main_navbar .o_menu_sections *,
.o_web_client .o_main_navbar .o_menu_sections * {
  background: $green-primary !important;
  background-color: $green-primary !important;
  color: white !important;

  &:hover, &:focus, &.show, &.active, &[aria-expanded="true"] {
    background: $green-darker !important;
    background-color: $green-darker !important;
  }
}

// Specifically target data-section spans and their parent elements
.o_menu_sections [data-section] {
  background: $green-primary !important;
  background-color: $green-primary !important;
}

.o_menu_sections > *:has([data-section]) {
  background: $green-primary !important;
  background-color: $green-primary !important;

  &:hover {
    background: $green-darker !important;
    background-color: $green-darker !important;
  }
}

// Override at html/body level with highest specificity
html, body, .o_web_client {
  --o-brand-odoo: #{$green-primary} !important;
  --o-brand-primary: #{$green-primary} !important;
  --o-enterprise-color: #{$green-primary} !important;
  --primary: #{$green-primary} !important;
  --bs-primary: #{$green-primary} !important;
  --o-main-color: #{$green-primary} !important;

  // Odoo 19 navbar specific variables
  --o-navbar-bg: #{$green-primary} !important;
  --o-navbar-color: white !important;
  --o-navbar-brand-color: white !important;
  --NavBar-background: #{$green-primary} !important;
  --NavBar-entry-bg: #{$green-primary} !important;
  --NavBar-entry-bg--hover: #{$green-darker} !important;
  --NavBar-entry-bg--active: #{$green-darker} !important;
  --NavBar-menuSections-bg: #{$green-primary} !important;
  --NavBar-menuSections-entry-bg: #{$green-primary} !important;
  --NavBar-menuSections-entry-bg--hover: #{$green-darker} !important;
  --NavBar-menuSections-entry-bg--active: #{$green-darker} !important;
}

// Override ALL Odoo color variables
:root {
  // Brand colors
  --o-brand-odoo: #{$green-primary} !important;
  --o-brand-primary: #{$green-primary} !important;
  --o-enterprise-color: #{$green-primary} !important;

  // THE PURPLE CULPRITS - override these!
  --o-cc4-bg: #{$green-primary} !important;
  --o-color-1: #{$green-primary} !important;
  --o-color-2: #{$green-dark} !important;
  --o-color-3: #{$green-darker} !important;
  --o-color-4: #{$green-primary} !important;
  --o-color-5: #{$green-light} !important;

  // Action colors
  --o-action-color: #{$green-primary} !important;
  --o-action-color-hover: #{$green-dark} !important;

  // Navbar colors
  --o-navbar-badge-bg: #{$green-dark} !important;
  --o-navbar-entry-active-bg: #{$green-darker} !important;
  --o-main-color: #{$green-primary} !important;
  --NavBar-entry-bg--active: #{$green-darker} !important;
  --NavBar-entry-bg--hover: #{$green-dark} !important;

  // Form colors
  --o-form-lightsecondary: #{$green-bg} !important;

  // Button colors
  --btn-primary-bg: #{$green-primary} !important;
  --btn-primary-border-color: #{$green-primary} !important;
  --btn-primary-hover-bg: #{$green-dark} !important;
  --btn-primary-hover-border-color: #{$green-dark} !important;
  --btn-primary-active-bg: #{$green-darker} !important;
  --btn-primary-active-border-color: #{$green-darker} !important;
}

// Force override on all elements that might have purple
* {
  --o-cc4-bg: #{$green-primary} !important;
  --o-color-1: #{$green-primary} !important;
}

// ============================================
// NAVBAR / TOP BAR - Complete override
// ============================================
.o_main_navbar {
  background-color: $green-primary !important;

  // All navbar items
  .o_menu_toggle,
  .o_menu_brand,
  .o_menu_sections,
  .o_menu_systray {
    background-color: transparent !important;
  }

  // Dropdown menus in navbar
  .dropdown-menu {
    .dropdown-item:hover,
    .dropdown-item:focus,
    .dropdown-item.active {
      background-color: $green-primary !important;
      color: white !important;
    }
  }

  // ============================================
  // APP SUBMENU - Projects, Tasks, Reporting, Configuration
  // These are the purple buttons that need green override
  // ============================================
  .o_menu_sections {
    // DEFAULT STATE - make background same green as navbar (not purple!)
    background-color: $green-primary !important;

    .o_nav_entry,
    .nav-item,
    > a,
    > button,
    > .dropdown,
    .o-dropdown,
    .nav-link,
    .dropdown-toggle {
      background-color: $green-primary !important;
      color: white !important;
    }

    // ALL possible submenu item selectors - HOVER/ACTIVE states
    .o_nav_entry,
    .nav-item,
    > a,
    > button,
    > .dropdown,
    .o-dropdown {
      &.active,
      &:hover,
      &:focus,
      &.show,
      &[aria-expanded="true"] {
        background-color: $green-darker !important;
        color: white !important;
      }
    }

    // Nav links inside menu sections
    .nav-link,
    .dropdown-toggle,
    a[data-menu-xmlid],
    button[data-menu-xmlid] {
      &.active,
      &:hover,
      &:focus,
      &.show {
        background-color: $green-darker !important;
        color: white !important;
      }
    }

    // Odoo 19 specific - app menu entries
    [data-section],
    .o-dropdown-item,
    .o_menu_entry_lvl_1,
    .o_menu_entry_lvl_2 {
      &:hover,
      &:focus,
      &.active {
        background-color: $green-darker !important;
        color: white !important;
      }
    }

    // Force override any purple background
    *[style*="background"] {
      background-color: $green-darker !important;
    }

    // Dropdown in menu sections
    .dropdown-menu {
      background-color: white !important;

      .dropdown-item {
        color: #333 !important;

        &:hover, &:focus, &.active {
          background-color: $green-primary !important;
          color: white !important;
        }
      }
    }
  }

  // Systray (right side icons)
  .o_menu_systray {
    .o-dropdown,
    .dropdown-toggle,
    > div {
      &:hover, &.show, &:focus {
        background-color: $green-darker !important;
      }
    }

    .o_MessagingMenu,
    .o_ActivityMenu {
      &.o-dropdown.show,
      &:hover {
        background-color: $green-darker !important;
      }
    }
  }

  // App switcher button
  .o_menu_toggle {
    &:hover, &:focus {
      background-color: $green-darker !important;
    }
  }

  // Breadcrumb area
  .o_menu_brand:hover {
    background-color: $green-darker !important;
  }
}

// ============================================
// APP SWITCHER / HOME MENU
// ============================================
.o_home_menu {
  .o_app {
    &:hover, &:focus {
      background-color: rgba($green-primary, 0.15) !important;
    }
  }

  .o_menuitem.o_focused,
  .o_menuitem:hover {
    background-color: rgba($green-primary, 0.15) !important;
  }
}

// App icons hover
.o_apps .o_app:hover {
  background-color: rgba($green-primary, 0.1) !important;
}

// ============================================
// BUTTONS
// ============================================
.o_web_client {
  .btn-primary,
  .btn-primary.disabled,
  .btn-primary:disabled {
    background-color: $green-primary !important;
    border-color: $green-primary !important;
    color: white !important;

    &:hover, &:focus {
      background-color: $green-dark !important;
      border-color: $green-dark !important;
    }

    &:active, &.active {
      background-color: $green-darker !important;
      border-color: $green-darker !important;
    }
  }

  .btn-outline-primary {
    color: $green-primary !important;
    border-color: $green-primary !important;

    &:hover, &:focus {
      background-color: $green-primary !important;
      border-color: $green-primary !important;
      color: white !important;
    }
  }

  .btn-link {
    color: $green-primary !important;

    &:hover {
      color: $green-dark !important;
    }
  }
}

// ============================================
// LINKS
// ============================================
.o_web_client {
  a:not(.btn):not(.nav-link):not(.dropdown-item) {
    color: $green-primary !important;

    &:hover, &:focus {
      color: $green-dark !important;
    }
  }
}

// ============================================
// FORM ELEMENTS
// ============================================
.o_web_client {
  // Tabs
  .nav-tabs .nav-link.active,
  .nav-tabs .nav-link:hover {
    border-bottom-color: $green-primary !important;
    color: $green-primary !important;
  }

  // Checkboxes
  .form-check-input:checked,
  .o_checkbox input:checked + span {
    background-color: $green-primary !important;
    border-color: $green-primary !important;
  }

  // Radio buttons
  .form-check-input[type="radio"]:checked {
    border-color: $green-primary !important;
    background-color: $green-primary !important;
  }

  // Focus states
  .form-control:focus,
  .form-select:focus {
    border-color: $green-primary !important;
    box-shadow: 0 0 0 0.2rem rgba($green-primary, 0.25) !important;
  }

  // Switch toggle
  .form-switch .form-check-input:checked {
    background-color: $green-primary !important;
    border-color: $green-primary !important;
  }
}

// ============================================
// KANBAN & LIST VIEWS
// ============================================
.o_web_client {
  // Kanban record hover
  .o_kanban_record:hover {
    border-color: $green-primary !important;
  }

  // List view selected row
  .o_list_view .o_data_row.o_data_row_selected,
  .o_list_view .o_data_row:focus-within {
    background-color: $green-bg !important;
  }

  // Kanban column header
  .o_kanban_header .o_kanban_title {
    &:hover {
      color: $green-primary !important;
    }
  }
}

// ============================================
// STATUSBAR
// ============================================
.o_web_client {
  .o_statusbar_status {
    button.btn-primary,
    button.o_arrow_button.btn-primary {
      background-color: $green-primary !important;
      border-color: $green-primary !important;

      &:hover {
        background-color: $green-dark !important;
      }
    }

    // Current status indicator
    .o_arrow_button.o_arrow_button_current {
      background-color: $green-primary !important;

      &::after {
        border-left-color: $green-primary !important;
      }
    }
  }
}

// ============================================
// BADGES & PILLS
// ============================================
.badge-primary,
.badge.bg-primary,
.bg-primary {
  background-color: $green-primary !important;
}

.badge.text-bg-primary {
  background-color: $green-primary !important;
  color: white !important;
}

// ============================================
// PROGRESS BARS
// ============================================
.progress-bar,
.o_progressbar .o_progressbar_complete {
  background-color: $green-primary !important;
}

// ============================================
// CALENDAR
// ============================================
.o_calendar_renderer {
  .fc-event,
  .fc-event-dot {
    background-color: $green-primary !important;
    border-color: $green-dark !important;
  }

  .fc-button-primary {
    background-color: $green-primary !important;
    border-color: $green-primary !important;

    &:hover, &:focus {
      background-color: $green-dark !important;
    }
  }
}

// ============================================
// CHATTER
// ============================================
.o_Chatter {
  .btn-primary {
    background-color: $green-primary !important;
    border-color: $green-primary !important;
  }

  .o_Chatter_sendButton {
    background-color: $green-primary !important;
  }
}

// ============================================
// MODALS / DIALOGS
// ============================================
.modal {
  .btn-primary {
    background-color: $green-primary !important;
    border-color: $green-primary !important;

    &:hover, &:focus {
      background-color: $green-dark !important;
      border-color: $green-dark !important;
    }
  }

  .modal-header {
    .btn-close:focus {
      box-shadow: 0 0 0 0.2rem rgba($green-primary, 0.25) !important;
    }
  }
}

// ============================================
// CONTROL PANEL
// ============================================
.o_control_panel {
  .btn-primary {
    background-color: $green-primary !important;
    border-color: $green-primary !important;
  }

  .o_searchview_input:focus {
    border-color: $green-primary !important;
  }
}

// ============================================
// BREADCRUMB
// ============================================
.breadcrumb-item a {
  color: $green-primary !important;

  &:hover {
    color: $green-dark !important;
  }
}

// ============================================
// MISC OVERRIDES
// ============================================

// Loading indicator
.o_loading_indicator {
  background-color: $green-primary !important;
}

// Tooltip
.tooltip.bs-tooltip-top .tooltip-arrow::before,
.tooltip.bs-tooltip-bottom .tooltip-arrow::before {
  border-top-color: $green-primary !important;
}

// Selection highlight
::selection {
  background-color: rgba($green-primary, 0.3) !important;
}

// Scrollbar (webkit)
::-webkit-scrollbar-thumb:hover {
  background-color: $green-primary !important;
}

// Focus outline
*:focus-visible {
  outline-color: $green-primary !important;
}

// ============================================
// AGGRESSIVE PURPLE OVERRIDE FOR ODOO 19
// Target any remaining purple (#714B67, #7C3A85, etc.)
// ============================================

// Override Odoo 19 CSS variables that might still be purple
.o_web_client,
.o_action_manager,
.o_main_navbar,
body {
  --o-brand-odoo: #{$green-primary} !important;
  --o-brand-primary: #{$green-primary} !important;
  --primary: #{$green-primary} !important;
  --bs-primary: #{$green-primary} !important;
  --bs-primary-rgb: 21, 128, 61 !important;

  // Odoo 19 specific app menu variables
  --o-navbar-entry-bg-hover: #{$green-darker} !important;
  --o-navbar-entry-bg-active: #{$green-darker} !important;
  --NavBar-menuSections-entry-bg--hover: #{$green-darker} !important;
  --NavBar-menuSections-entry-bg--active: #{$green-darker} !important;
  --o-menu-sections-link-bg-active: #{$green-darker} !important;
}

// Force override on navbar menu sections specifically
.o_main_navbar .o_menu_sections {
  // Target elements with inline styles or computed purple backgrounds
  > * {
    &:hover,
    &.active,
    &:focus,
    &.show {
      background-color: $green-darker !important;
      background: $green-darker !important;
    }
  }

  // Specifically target the submenu buttons/links
  .nav-link:hover,
  .nav-link.active,
  .nav-link:focus,
  .nav-link.show,
  button:hover,
  button.active,
  a:hover,
  a.active {
    background-color: $green-darker !important;
    background: $green-darker !important;
    color: white !important;
  }
}
